\section{Monotonicidade, convexidade e matrizes Monge}
\label{MatrizMonge}

%----------------------------------------------------------------------------------------

Aqui serão apresentados e explorados os conceitos de monotonicidade, convexidade e matrizes Monge, além disso, alguns resultados referentes a estes conceitos serão demonstrados. Estes conceitos são fundamentais para o desenvolvimento do restante do trabalho.

\begin{defi}[Vetor monótono]
Seja $a \in \B{Q}^n$ um vetor, $a$ é dito monótono quando vale uma das propriedades abaixo.
    \begin{itemize}
        \item Se para todo $i,j \in [n]$, $i < j \so a_i \leq a_j$, $a$ é dito monótono crescente (ou só crescente).
        \item Se para todo $i,j \in [n]$, $i < j \so a_i \geq a_j$, $a$ é dito monótono decrescente (ou só decrescente).
    \end{itemize}
\end{defi}

Sabemos que a monotonicidade de vetores pode ser aproveitada para agilizar alguns algoritmos importantes, por exemplo, a busca binária pode ser interpretada como uma otimização da busca linear para vetores monótonos. 

\begin{defi}[Vetor convexo]
Seja $a \in \B{Q}^n$ um vetor,
    \begin{itemize}
        \item se para todo $i,j,k \in [n]$, $i < j < k \so a_j \leq \frac{(j-k)a_i + (i-j)a_k}{i-k}$, $a$ é dito convexo e
        \item se para todo $i,j,k \in [n]$, $i < j < k \so a_j \geq \frac{(j-k)a_i + (i-j)a_k}{i-k}$, $a$ é dito côncavo.
    \end{itemize}
\end{defi}

Vale notar que a definição dada acima é específica para vetores porém é compatível com a definição usual de funções convexas, isto é, $a$ é convexa se e somente se existe uma função $f$ convexa tal que para todo $i \in [n]$, $a_i = f(i)$. A afirmação análoga para a concavidade também é verdadeira.  

Assim como a monotonicidade, a convexidade também é usualmente explorada para agilizar algoritmos, por exemplo, se um vetor é estritamente convexo (basta substituir $\leq$ por $<$ na definição) podemos encontrar o mínimo (que é único) com uma busca ternária ao invés de percorrer todo o vetor.  

\begin{defi}
Seja $A \in \B{Q}^{n \times m}$, definimos quatro vetores a seguir.
\todo{Talvez essa definição vá para a introdução. Prometo não usar essa notação estranha sem aviso.}
    \begin{itemize}
        \item O vetor de índices de máximos das linhas de $A$ guarda na posição $i$ 
              o número $\min\{j \in [m] \mid A[i][j] \geq A[i][j'] \text{ para todo } j' \in [m]\}$. 
        \item $\check{j_A} \in \B{Q}^n : i \mapsto \min\{j \in [m] \mid A[i][j] \leq A[i][j'] \text{ para todo } j' \in [m]\}$, o vetor de índices de mínimos das linhas de $A$,
        \item $\hat{i_A} \in \B{Q}^m : j \mapsto \min\{i \in [n] \mid A[i][j] \geq A[i'][j] \text{ para todo } i' \in [n]\}$, o vetor de índices de máximos das colunas de $A$ e 
        \item $\check{i_A} \in \B{Q}^m : j \mapsto \min\{i \in [n] \mid A[i][j] \leq A[i'][j] \text{ para todo } i' \in [n]\}$, o vetor de índices de mínimos das colunas de $A$.
    \end{itemize}

Note que o índice de máximo de uma linha é definido como o menor índice que contém o valor máximo daquela linha. O mesmo vale para colunas e mínimos.
\end{defi}

Calcular estes vetores para dadas matrizes é um problema interessante. Algumas propriedades das matrizes podem ser exploradas a fim de agilizar este cálculo. A monotonicidade, convexidade ou concavidade de matrizes indicam propriedades interessantes sobre estes problemas, portanto, vamos explorar estas definições.

\begin{defi}[Matriz monótona]
Seja $A \in \B{Q}^{n \times m}$ uma matriz. Se $A$ tiver o vetor de índices de máximos das linhas monótono, $A$ é dita monótona nos máximos das linhas. 

Valem também as definições análogas para mínimos ou colunas e pode-se especificar monotonicidade crescente ou decrescente.
\end{defi}

\begin{defi}[Matriz totalmente monótona]
Seja $A \in \B{Q}^{n \times m}$ uma matriz.
    \begin{itemize}
        \item Se $A[i][j'] > A[i][j]$ implica $A[i'][j'] > A[i'][j]$ para todo $1 \leq i < i' \leq n$ e $1 \leq j < j' \leq m$, $A$ é monótona convexa nas linhas.
        \item Se $A[i][j'] < A[i][j]$ implica $A[i'][j'] < A[i'][j]$ para todo $1 \leq i < i' \leq n$ e $1 \leq j < j' \leq m$, $A$ é monótona côncava nas linhas.
        \item Se $A[i'][j] > A[i][j]$ implica $A[i'][j'] > A[i][j']$ para todo $1 \leq i < i' \leq n$ e $1 \leq j < j' \leq m$, $A$ é monótona convexa nas colunas.
        \item Se $A[i'][j] < A[i][j]$ implica $A[i'][j'] < A[i][j']$ para todo $1 \leq i < i' \leq n$ e $1 \leq j < j' \leq m$, $A$ é monótona côncava nas colunas.
    \end{itemize}
\end{defi}

O motivo do uso dos termos ``convexa'' e ``côncava'' neste contexto são justificados pelo Teorema~\ref{convexRelation}. Note que se uma matriz é totalmente monótona, todas as suas submatrizes são totalmente monótonas no mesmo sentido. O seguinte lema caracteriza uma propriedade importante sobre matrizes totalmente monótonas.  

\begin{lema}
Se $A \in \B{Q}^{n \times m}$ é uma matriz totalmente monótona convexa nas linhas.
    \begin{enumerate}
        \item Toda submatriz de $A$ é monótona crescente nos máximos das linhas.
        \item Toda submatriz de $A$ é monótona decrescente nos mínimos das linhas.
    \end{enumerate}

Simetricamente, se $A$ é côncava nas linhas, suas submatrizes são decrescentes nos máximos e crescentes nos mínimos das linhas. O lema funciona análogamente em termos de colunas, também.  
\end{lema}

\begin{proof}
Seja $A \in \B{Q}^{n \times m}$ uma matriz totalmente monótona convexa nas linhas. Vamos provar que $A$ é monótona crescente nos máximos das linhas. Sejam $i < i'$ índices de linhas de $A$. Seja $j'$ o índice de máximo da linha $i$ e $j$ o índice de máximo da linha $i'$. Suponha, por absurdo, $j < j'$. Assim, teremos, já que $j'$ é o máximo na $i$-ésima linha, $A[i][j'] > A[i][j]$ e, por outro lado, já que $j$ é o máximo na $i'$-ésima, $A[i'][j] \geq A[i'][j']$, porém, $A$ é totalmente monótona, portanto, $A[i'][j'] > A[i'][j]$, uma contradição.  

Agora, vamos mostrar que $A$ é monótona decrescente nos mínimos das linhas. Sejam $i < i'$ índices de linhas de $A$. Seja $j$ o índice de mínimo da linha $i$ e $j'$ o índice de mínimo da linha $i'$. Suponha, por absurdo, $j < j'$. Assim, teremos $A[i][j] \leq A[i][j']$ e $A[i'][j'] < A[i'][j]$
\end{proof}
